
  <div class="dashboard-content">

    <!-- Top Stats -->
    <div class="stats-row">
      <div class="stat-card">
        <div class="stat-label">Total Revenue</div>
        <div class="stat-value">${{ revenue | number:'1.2-2' }}</div>
        <div class="stat-metric">
          <div class="stat-period">All-time company sales</div>
          <div *ngIf="revenueGrowthAvailable" class="growth-indicator">
            <span [ngClass]="{
              'trend-up': isRevenueIncreasing && !isRevenueZero, 
              'trend-down': !isRevenueIncreasing && !isRevenueZero,
              'trend-zero': isRevenueZero
            }">
              {{ isRevenueZero ? '' : (isRevenueIncreasing ? '↑' : '↓') }} {{ revenueGrowth | number:'1.1-1' }}%
            </span>
            <span class="growth-period">vs last month</span>
          </div>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-label">Today Revenue</div>
        <div class="stat-value" *ngIf="todayRevenueAvailable">${{ todayRevenue | number:'1.2-2' }}</div>
        <div class="stat-value" *ngIf="!todayRevenueAvailable">$0.00</div>
        <div class="stat-metric">
          <span class="stat-period" *ngIf="todayRevenueAvailable">{{ currentDate | date:'mediumDate' }}</span>
          <span class="stat-period" *ngIf="!todayRevenueAvailable">No sales today</span>
          <div *ngIf="todayRevenueGrowthAvailable" class="growth-indicator">
            <span [ngClass]="{
              'trend-up': isTodayRevenueIncreasing && !isTodayRevenueZero, 
              'trend-down': !isTodayRevenueIncreasing && !isTodayRevenueZero,
              'trend-zero': isTodayRevenueZero
            }">
              {{ isTodayRevenueZero ? '' : (isTodayRevenueIncreasing ? '↑' : '↓') }} {{ todayRevenueGrowth | number:'1.1-1' }}%
            </span>
            <span class="growth-period">vs yesterday</span>
          </div>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-label">Today Orders</div>
        <div class="stat-value" *ngIf="todayOrdersAvailable">{{ todayOrders }}</div>
        <div class="stat-value" *ngIf="!todayOrdersAvailable">0</div>
        <div class="stat-metric">
          <span class="stat-period" *ngIf="todayOrdersAvailable">{{ currentDate | date:'mediumDate' }}</span>
          <span class="stat-period" *ngIf="!todayOrdersAvailable">No orders today</span>
          <div *ngIf="todayOrdersGrowthAvailable" class="growth-indicator">
            <span [ngClass]="{
              'trend-up': isTodayOrdersIncreasing && !isTodayOrdersZero, 
              'trend-down': !isTodayOrdersIncreasing && !isTodayOrdersZero,
              'trend-zero': isTodayOrdersZero
            }">
              {{ isTodayOrdersZero ? '' : (isTodayOrdersIncreasing ? '↑' : '↓') }} {{ todayOrdersGrowth | number:'1.1-1' }}%
            </span>
            <span class="growth-period">vs yesterday</span>
          </div>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-label">Total Customers</div>
        <div class="stat-value">{{ totalCustomers | number }}</div>
        <div class="stat-metric">
          <div class="stat-period">${{ averageOrderAmount | number:'1.2-2' }} Average Order</div>
          <div *ngIf="totalCustomersGrowthAvailable" class="growth-indicator">
            <span [ngClass]="{
              'trend-up': isTotalCustomersIncreasing && !isTotalCustomersZero, 
              'trend-down': !isTotalCustomersIncreasing && !isTotalCustomersZero,
              'trend-zero': isTotalCustomersZero
            }">
              {{ isTotalCustomersZero ? '' : (isTotalCustomersIncreasing ? '↑' : '↓') }} {{ totalCustomersGrowth | number:'1.1-1' }}%
            </span>
            <span class="growth-period">vs last month</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Sales Funnel + Device Category -->
    <div class="middle-row">
      <div class="chart-card sales-funnel">
        <div class="card-header">
          <h2>Sales Funnel</h2>
          <div class="period-selector">
            <select [(ngModel)]="selectedPeriod" (change)="onPeriodChange()">
              <option value="month">This Month</option>
              <option value="threeMonths">Last Three Months</option>
              <option value="sixMonths">Last Six Months</option>
              <option value="year">This Year</option>
            </select>
          </div>
        </div>
        <div class="chart-container">
          <canvas #salesFunnelChart></canvas>
        </div>
      </div>

      <div class="chart-card device-category">
        <div class="card-header">
          <h2>Device Category</h2>
        </div>
        <div class="device-stats">
          <div class="device-row">
            <div class="device-icon mobile"></div>
            <div class="device-name">Mobile</div>
            <div class="device-percentage">{{ mobilePercentage }}%</div>
          </div>
          <div class="device-row">
            <div class="device-icon desktop"></div>
            <div class="device-name">Desktop</div>
            <div class="device-percentage">{{ desktopPercentage }}%</div>
          </div>
          <div class="device-row">
            <div class="device-icon tablet"></div>
            <div class="device-name">Tablet</div>
            <div class="device-percentage">{{ tabletPercentage }}%</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Campaigns + Top Countries -->
    <div class="bottom-row">
      <div class="chart-card campaign-performance">
        <div class="card-header">
          <h2>Campaign Performance</h2>
          <div class="see-all" *ngIf="campaigns && campaigns.length > 3" (click)="showAllCampaignsModal()">See All</div>
        </div>
        <div *ngIf="campaigns && campaigns.length > 0">
          <table class="campaign-table">
            <thead>
              <tr>
                <th>Campaign</th>
                <th>Impressions</th>
                <th>Clicks</th>
                <th>CPC</th>
                <th>Spend</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let campaign of campaigns | slice:0:3">
                <td>
                  <div class="campaign-info">
                    <div class="campaign-icon" [ngStyle]="{ 'background-color': campaign.color }">
                      <span>{{ campaign.icon }}</span>
                    </div>
                    <span>{{ campaign.name }}</span>
                  </div>
                </td>
                <td>{{ campaign.impressions }}</td>
                <td>{{ campaign.clicks }}%</td>
                <td>${{ campaign.cpc }}</td>
                <td>${{ campaign.spend }}</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="no-data-message" *ngIf="!campaigns || campaigns.length === 0">
          <p>Loading campaign data...</p>
        </div>
      </div>

      <div class="chart-card top-countries">
        <div class="card-header">
          <h2>Top Countries</h2>
        </div>
        <div class="countries-list">
          <div class="country-row" *ngFor="let country of topCountries">
            <div class="country-flag" [ngClass]="country.code"></div>
            <div class="country-name">{{ country.name }}</div>
            <div class="country-percentage">{{ country.percentage }}%</div>
          </div>
        </div>
      </div>
    </div>

    <!-- All Campaigns Modal Popup -->
    <div class="modal-overlay" *ngIf="showAllCampaigns" (click)="closeAllCampaignsModal($event)">
      <div class="modal-content">
        <div class="modal-header">
          <h2>All Campaign Performance</h2>
          <button class="close-modal-btn" (click)="showAllCampaigns = false">×</button>
        </div>
        <div class="modal-body">
          <div class="table-container" *ngIf="campaigns && campaigns.length > 0">
            <table class="campaign-details-table">
              <thead>
                <tr>
                  <th>Campaign</th>
                  <th>Impressions</th>
                  <th>Clicks</th>
                  <th>CPC</th>
                  <th>Spend</th>
                  <th>Company ID</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let campaign of campaigns">
                  <td>
                    <div class="campaign-info">
                      <div class="campaign-icon" [ngStyle]="{ 'background-color': campaign.color }">
                        <span>{{ campaign.icon }}</span>
                      </div>
                      <span>{{ campaign.name }}</span>
                    </div>
                  </td>
                  <td>{{ campaign.impressions }}</td>
                  <td>{{ campaign.clicks }}%</td>
                  <td>${{ campaign.cpc }}</td>
                  <td>${{ campaign.spend }}</td>
                  <td>{{ campaign.companyId || 'N/A' }}</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="no-data-message" *ngIf="!campaigns || campaigns.length === 0">
            <p>Loading campaign data...</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Print -->
    <div class="print-report">
      <button (click)="printReport()">
        Print Report
        <span class="material-icons">print</span>
      </button>
    </div>

  </div>
