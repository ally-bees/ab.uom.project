<div class="expenses-container">
  <div *ngIf="loading" class="loading-message">Loading...</div>
  <div *ngIf="error" class="error-message">Failed to load data. Please try again later.</div>
  
  <div class="header">
    <div class="logo">
      <!-- Your SVG here -->
    </div>
    <h2>Expense Details</h2>
  </div>

  <div class="form-container">
    <form [formGroup]="expenseForm" (ngSubmit)="onSubmit()" class="expense-form">
      <!-- Basic Details Section -->
      <div class="section-wrapper">
        <div class="section-header">
          <div class="section-number">1</div>
          <h3>Basic Details</h3>
        </div>

        <div class="section">
          <div class="form-row">
            <div class="form-group">
              <label for="position">Employee Position</label>
              <select id="position" formControlName="position" class="form-control">
                <option value="" disabled>Select Position</option>
                <option *ngFor="let position of positions" [value]="position">{{position}}</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="employeeName">Employee Name</label>
              <input type="text" id="employeeName" formControlName="employeeName" class="form-control" />
            </div>
          </div>
        </div>
      </div>

      <!-- Expense Details Section -->
      <div class="section-wrapper">
        <div class="section-header">
          <div class="section-number">2</div>
          <h3>Expense Details</h3>
        </div>
        
        <div class="section">
          <div class="form-row">
            <div class="form-group">
              <label for="expenseType">Expense Type</label>
              <select id="expenseType" formControlName="expenseType" class="form-control">
                <option value="" disabled>Select Expense Type</option>
                <option *ngFor="let type of expenseTypes" [value]="type">{{type}}</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="amount">Amount</label>
              <input type="text" id="amount" formControlName="amount" class="form-control" />
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="date">Date</label>
              <mat-form-field appearance="outline" class="date-picker-field" style="width: 100%;">
                <input
                  matInput
                  [matDatepicker]="picker"
                  placeholder="MM/DD/YYYY"
                  formControlName="date"
                  [max]="today"
                />
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
                
                <mat-error *ngIf="expenseForm.get('date')?.hasError('max')">
                  Date cannot be in the future.
                </mat-error>
              </mat-form-field>
            </div>
          </div>
        </div>
      </div>

      <!-- Additional Details Section -->
      <div class="section-wrapper">
        <div class="section-header">
          <div class="section-number">3</div>
          <h3>Additional Details</h3>
        </div>
        
        <div class="section">
          <div class="form-group">
            <label for="paymentMethod">Payment Method</label>
            <select id="paymentMethod" formControlName="paymentMethod" class="form-control">
              <option value="" disabled>Select method</option>
              <option *ngFor="let method of paymentMethods" [value]="method">{{method}}</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="receipt">Receipt Upload</label>
            <div class="file-upload">
              <input
                type="text"
                readonly
                class="file-name"
                [value]="selectedFile ? selectedFile.name : 'No File Chosen'"
              />
              <input type="file" id="receipt" (change)="onFileSelected($event)" formControlName="receipt" hidden />
              <label for="receipt" class="browse-btn">Browse</label>
            </div>
          </div>
          
          <div class="form-group">
            <label for="description">Description</label>
            <textarea
              id="description"
              formControlName="description"
              placeholder="Enter expense description"
              class="form-control"
            ></textarea>
          </div>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-cancel" (click)="cancelForm()">Cancel</button>
        <button type="submit" class="btn btn-save" [disabled]="isLoading">
          {{ isLoading ? 'Saving...' : 'Save' }}
        </button>
      </div>
    </form>
  </div>

  <!-- Recent Expenses Section -->
  <div class="recent-expenses" *ngIf="recentExpenses && recentExpenses.length > 0">
    <h3>Recent Expenses</h3>
    <table class="expenses-table">
      <thead>
        <tr>
          <th>Date</th>
          <th>Employee</th>
          <th>Position</th>
          <th>Type</th>
          <th>Amount</th>
          <th>Receipt</th>
        </tr>
      </thead>
      <tbody>
  <tr *ngFor="let expense of recentExpenses">
    <td>{{ expense.date | date:'MM/dd/yyyy' }}</td>
    <td>{{ expense.employeeName }}</td>
    <td>{{ expense.position }}</td>
    <td>{{ expense.expenseType }}</td>
    <td>Rs. {{ expense.amount.toFixed(2) }}</td>
    <td>
  <ng-container *ngIf="expense.fullReceiptUrl; else noReceipt">
    <a [href]="expense.fullReceiptUrl" target="_blank">Download Receipt</a>
  </ng-container>
  <ng-template #noReceipt>
    <span>No Receipt</span>
  </ng-template>
</td>

  </tr>
</tbody>

    </table>
  </div>
</div>
